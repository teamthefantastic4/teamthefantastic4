<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">

    <title>Hospitalization Prediction</title>
</head>
<body>

    <div class="container">
        <header >Caring for Yourself</header>
        <h4>Hospitalization Prediction</h4>
        
        <form action="/" method="post" id="myForm">
            <div class="form first">
                <div class="details personal">
                    <span class="title">Personal Details</span>
    
                    <div class="fields">

                        <!--agey -->
                        <div class="input-field">
                            <label>Enter your Age:</label>
                            <input type="number" name="n1" placeholder="Fill this field">
                        </div>

                        <!--ragender -->
                        <div class="input-field">
                            <label>Gender?</label>
                            <select value=0 name=n2 class="select1">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">Male</option>
                                <option value=2 class="opt2">Female</option>
                            </select>
                        </div>                        

                        <!--momage -->
                        <div class="input-field">
                            <label>Mother's age - current/at death:</label>
                            <input type="number" name="n3" placeholder="Fill this field">
                        </div>

                        <!--dadage -->
                        <div class="input-field">
                            <label>Father's age - current/at death:</label>
                            <input type="number" name="n4" placeholder="Fill this field">
                        </div>

                        <!--livsib-->
                        <div class="input-field">
                            <label>Number of living siblings?</label>
                            <input name=n5 type="number" placeholder="Fill this field">
                        </div>

                        <!--grchild-->
                        <div class="input-field">
                            <label>Number of Grandchildren?</label>
                            <input name=n6 type="number" placeholder="Fill this field">
                        </div>

                        <!--shlt-->
                        <div class="input-field">
                            <label>Self Report Of Health?</label>
                            <select value=0 name=n7 class="select7">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">Excellent</option>
                                <option value=2 class="opt2">Very Good</option>
                                <option value=3 class="opt3">Good</option>
                                <option value=4 class="opt4">Fair</option>
                                <option value=5 class="opt4">Poor</option>
                            </select>
                        </div>

                        <!--vscan : "Visual Scanning report"-->
                        <div class="input-field">
                            <label>Had Visibility Problems?</label>
                            <select value=0 name=n8 class="select8">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1   class="opt2">Yes</option>
                            </select>
                        </div>
                        
                        <!-- cholst -->
                        <div class="input-field">
                            <label>Cholesterol?</label>
                            <select value=0 name=n9 class="select9">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>

                        <!--weight-->
                        <div class="input-field">
                            <label>Weight (Kg):</label>
                            <input name=n10 type="number" placeholder="Fill this field">
                        </div>

                        <!--height-->
                        <div class="input-field">
                            <label>Height (Meters):</label>
                            <input name=n11 type="number" placeholder="Fill this field">
                        </div>

                        <!--bmi-->
                        <div class="input-field">
                            <label>BMI ( W / (H * H) )</label>
                            <select value=0 name=n12 class="select12">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=18 class="opt1">Below 18.5</option>
                                <option value=23 class="opt2">18.5 To 24.9</option>
                                <option value=27 class="opt3">25 To 29.9</option>
                                <option value=33 class="opt4">30 To 34.9</option>
                            </select>
                        </div>

                        <!--mobila -->           
                        <div class="input-field">
                            <label>Rate Your Mobility: </label>
                            <select value=0 name=n13 class="select13">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">Excellent</option>
                                <option value=2 class="opt2">Very good</option>
                                <option value=3 class="opt1">Good</option>
                                <option value=4 class="opt2">Fair</option>
                                <option value=5 class="opt2">Poor</option>
                            </select>
                        </div>

                        <!--grossaa -->           
                        <div class="input-field">
                            <label>Rate Your Gross Motor Movements (biking, climbing, jumping)</label>
                            <select value=0 name=n14 class="select14">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">Excellent</option>
                                <option value=2 class="opt2">Very good</option>
                                <option value=3 class="opt1">Good</option>
                                <option value=4 class="opt2">Fair</option>
                                <option value=5 class="opt2">Poor</option>
                            </select>
                        </div>

                        <!-- adltot_m -->
                        <div class="input-field">
                            <label>Is Hard To Perform Activities Of Daily Living?</label>
                            <select value=0 name=n15 class="select15">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">No</option>
                                <option value=2 class="opt2">Yes</option>
                                <option value=4 class="opt2">Sometimes</option>
                            </select>
                        </div>

                        <!-- walkra -->
                        <div class="input-field">
                            <label>Difficulty-Walking Across Room?</label>
                            <select value=0 name=n16 class="select16">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1   class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- walksa -->
                        <div class="input-field">
                            <label>Difficulty-Walking Several Blocks? (Rate) </label>
                            <select value=0 name=n17 class="select17">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">Some</option>
                                <option value=2 class="opt2">Much</option>
                                <option value=3 class="opt2">Very Much</option>
                                <option value=4 class="opt2">Too Much</option>
                            </select>
                        </div>

                        <!-- push -->
                        <div class="input-field">
                            <label>Difficulty To Push/Pull Large Objects? (Rate) </label>
                            <select value=0 name=n18 class="select18">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">Some</option>
                                <option value=2 class="opt2">Much</option>
                                <option value=3 class="opt2">Too Much</option>
                                <option value=4 class="opt2">Very Much</option>
                            </select>
                        </div>

                        <!-- lift -->
                        <div class="input-field">
                            <label>Difficulty To Lift +5 Kgs? (Rate) </label>
                            <select value=0 name=n19 class="select19">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=1 class="opt1">Some</option>
                                <option value=2 class="opt2">Much</option>
                                <option value=3 class="opt2">Too Much</option>
                                <option value=4 class="opt2">Very Much</option>
                            </select>
                        </div>

                        <!--fallinj -->
                        <div class="input-field">
                            <label>Had Injures from Any fall?</label>
                            <select value=0 name=n20 class="select20">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.5 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>

                        <!--hip_m -->
                        <div class="input-field">
                            <label>In the past two years, have you had a serious fracture?</label>
                            <select value=0 name=n21 class="select21">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1   class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- hrtatte -->
                        <div class="input-field">
                            <label>Ever Has a Heartache?</label>
                            <select value=0 name=n22 class="select22">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1   class="opt2">Yes</option>
                            </select>
                        </div>
                        
                        <!-- rxdiabi -->
                        <div class="input-field">
                            <label>Take Medication For Diabetes?</label>
                            <select value=0 name=n23 class="select23">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- "rxhrtat":  "Whether R takes meds for heart attack", -->
                        <div class="input-field">
                            <label>Take Medication For Prevent Heartache?</label>
                            <select value=0 name=n24 class="select24">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1   class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- "rxstrok":  "Whether R takes medication for stroke", -->
                        <div class="input-field">
                            <label>Takes Medication For Prevent Stroke?</label>
                            <select value=0 name=n25 class="select25">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- "rxhibp":   "Whether R takes meds for high blood pressure",                         -->
                        <div class="input-field">
                            <label>Take Medication For High Blood Pressure?</label>
                            <select value=0 name=n26 class="select26">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- "rxarthr":  "Whether R takes medication for arthritis", -->
                        <div class="input-field">
                            <label>Takes Medication For Arthritis?</label>
                            <select value=0 name=n27 class="select27">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- "rxlung_m": "Whether R takes meds for lung disease", -->
                        <div class="input-field">
                            <label>Takes Medication For Lung Disease?</label>
                            <select value=0 name=n28 class="select28">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>

                        <!-- "cncrsurg": "received treatment for cancer (surgery)", -->
                        <div class="input-field">
                            <label>Received Treatment For Cancer (Surgery)?</label>
                            <select value=0 name=n29 class="select29">
                                <option class="none" selected disabled>Select an option</option>
                                <option value=0.1 class="opt1">No</option>
                                <option value=1 class="opt2">Yes</option>
                            </select>
                        </div>
                        
                        <div class="buttons">
                            <div class="resetBtn" id="resetButton">
                                <span class="btnText">Reset Form</span>
                            </div>
    
                            <button class="resultBtn" type="button" id="submitBtn">
                                <span class="btnText">My Result</span>
                            </button>
                        </div>

                    </div>
                </div>
            </div>

            <!---RESULT PAGE-->
            <div class="form second">
                <div class="details personal">
                    
                    <div class="diagnosis">
                        <label class="labelPredict" id="predictLabel"></label><br>
                        <span class="predictText" id="predictTxt"></span><br>
                        <label class="labelScore" id="scoreLabel"></label><br>
                        <span class="scoreText" id="scoreTxt"></span>
                    </div>

                    
                    <div class="fields">
                        <div class="buttons">
                            <div class="backBtn" id="backButton">
                                <span class="btnText">Back to Form</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script>
        $(document).ready(function () {

            $("#backButton").click(function () {
                            $(".form.first").show();
                            $(".form.second").show();
            })

            $("#submitBtn").click(function () {

            // Calcular BMI y almacenarlo en el campo oculto
                var height = parseFloat($("input[name='height']").val());
                var weight = parseFloat($("input[name='weight']").val());
                var bmi = weight / (height * height);
                $("#bmi").val(bmi.toFixed(2)); // Almacenar el valor del BMI con dos decimales

            // Get the form data
                var formData = $("#myForm").serialize();

        // Make the AJAX request to the server
                $.ajax({
                    type: "POST",
                    url: "/", // The path of the POST view
                    data: formData,
                    success: function (data) {
                        // Show the results and hide the form
                        $(".form.first").hide();
                        $(".form.second").show();

                        if(data.success == false){
                            $("#predictTxt").text(data.prediction);
                        }
                        else {
                            $("#predictLabel").text(data.prediction_label)
                            $("#predictTxt").text(data.prediction);
                            $("#scoreLabel").text(data.score_label)
                            $("#scoreTxt").text(data.score);
                        }
                    },
                    error: function (data) {
                        alert("Error attempting a request.");
                    },
                });
            });
        });
    </script>
</body>
</html>